generator client {
  provider = "prisma-client"
  output   = "../lib/generated/prisma"
}

datasource db {
  provider = "postgresql"
}



enum UserRole {
  USER
  DOCTOR
  ADMIN
}

enum AppointmentStatus {
  PENDING
  CONFIRMED
  COMPLETED
  CANCELLED
}

enum ArticleCategory {
  WOMEN_HEALTH
  CHILD_HEALTH
  MENTAL_HEALTH
  SEASONAL_DISEASE
  GENERAL
}


model User {
  id            String      @id @default(cuid())
  clerkUserId   String      @unique
  name          String?
  email         String?
  phone         String?
  role          UserRole    @default(USER)
  preferredLang String      @default("en")

  appointments  Appointment[]
  aiQueries     AIQuery[]

  createdAt     DateTime    @default(now())
  updatedAt     DateTime    @updatedAt
}

model Doctor {
  id                String      @id @default(cuid())
  name              String
  specialization    String
  hospital          String
  experienceYears   Int
  consultationFee   Int
  city              String
  languages         String[]    // ["hi", "en", "ta"]
  isVerified        Boolean     @default(false)
  isOnlineAvailable Boolean     @default(false)

  appointments      Appointment[]

  createdAt         DateTime    @default(now())
  updatedAt         DateTime    @updatedAt
}

model Appointment {
  id          String              @id @default(cuid())
  userId      String
  doctorId    String
  date        DateTime
  status      AppointmentStatus  @default(PENDING)
  notes       String?

  user        User    @relation(fields: [userId], references: [id], onDelete: Cascade)
  doctor      Doctor  @relation(fields: [doctorId], references: [id], onDelete: Cascade)

  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model AIQuery {
  id           String   @id @default(cuid())
  userId       String?
  inputText    String
  responseText String
  language     String
  topic        String?
  location     String?

  user         User?    @relation(fields: [userId], references: [id], onDelete: SetNull)

  createdAt    DateTime @default(now())
}

model Article {
  id          String          @id @default(cuid())
  title       String
  slug        String          @unique
  content     String
  category    ArticleCategory
  language    String          @default("en")
  isPublished Boolean         @default(false)
  author      String?

  createdAt   DateTime        @default(now())
  updatedAt   DateTime        @updatedAt
}